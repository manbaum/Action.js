(function(){var n,r;r=function(){},n=function(){function n(n){this.action=n}return n.prototype._go=function(n){return this.action(n)},n.prototype.next=function(r){var t;return t=this,new n(function(e){return t.action(function(t){var u;return t instanceof Error?e(t):(u=r(t),u instanceof n?u._go(e):e(u))})})},n.prototype.guard=function(r){var t;return t=this,new n(function(e){return t.action(function(t){var u;return t instanceof Error?(u=r(t),u instanceof n?u._go(e):e(u)):e(t)})})},n.prototype.go=function(n){return this.action(function(r){if(r instanceof Error)throw r;return null!=n?n(r):void 0})},n}(),n.wrap=function(r){return new n(function(n){return n(r)})},n.safe=function(n,r){return function(t){var e;try{return r(t)}catch(u){return e=u,n}}},n.safeRaw=function(n){return function(r){var t;try{return n(r)}catch(e){return t=e}}},n.sequence=function(r){return function(t){var e,u,o,i,c;if(r.length>0){for(e=r[0](t),c=r.slice(1),u=0,o=c.length;o>u;u++)i=c[u],e=e.next(i);return e}return n.wrap(new Error("No monadic actions given"))}},n.any=function(t){return new n(function(n){var e,u,o,i;for(i=[],u=0,o=t.length;o>u;u++)e=t[u],i.push(e._go(function(t){return n(t),n=r}));return i})},n.anySuccess=function(t){var e;return e=t.length,new n(function(n){var u,o,i,c;for(c=[],o=0,i=t.length;i>o;o++)u=t[o],c.push(u._go(function(t){return e--,t instanceof Error?0===e?n(new Error("All actions failed")):void 0:(n(t),n=r,e=-1)}));return c})},n.retry=function(n,r){var t;return t=r.guard(function(){return 0!==n--?t:new Error("Retry limit reached")})},n.gapRetry=function(r,t,e){var u;return u=e.guard(function(){return new n(function(n){return setTimeout(n,t)}).next(function(){return 0!==r--?u:new Error("Retry limit reached")})})},n.all=function(t){var e,u;return u=[],e=t.length,new n(function(n){var o,i,c,f,a;for(a=[],i=c=0,f=t.length;f>c;i=++c)o=t[i],a.push(function(t){return o._go(function(o){return e--,o instanceof Error?(n(o),n=r):(u[t]=o,0===e?n(u):void 0)})}(i));return a})},n.allSuccess=function(r){var t,e;return e=[],t=r.length,new n(function(n){var u,o,i,c,f;for(f=[],o=i=0,c=r.length;c>i;o=++i)u=r[o],f.push(function(r){return u._go(function(u){return t--,e[r]=u,0===t?n(e):void 0})}(o));return f})},n.sequenceTry=function(r,t){var e,u,o;return o=r.length,u=0,e=function(n){return t(n).guard(function(){return u++<o?e(r[u]):new Error("Try limit reached")})},o>0?e(r[0]):n.wrap(new Error("No argmuents for monadic"))},n.mkNodeAction=function(r,t){return new n(function(n){return r(t,function(r,t){return n(r?r:t)})})},window.Action=n}).call(this);