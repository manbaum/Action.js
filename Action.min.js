(function(){var n,r,t,e,o;r=function(r,t){return t instanceof n?t._go(r):r(t)},n=function(){function n(n){this._go=n}return n.prototype._next=function(t){var e;return e=this._go,new n(function(n){return e(function(e){return r(n,t(e))})})},n.prototype.next=function(t){var e;return e=this._go,new n(function(n){return e(function(e){return e instanceof Error?n(e):r(n,t(e))})})},n.prototype.guard=function(t){var e;return e=this._go,new n(function(n){return e(function(e){return e instanceof Error?r(n,t(e)):n(e)})})},n.prototype.go=function(n){return this._go(function(r){if(r instanceof Error)throw r;return"function"==typeof n?n(r):void 0})},n}(),n.wrap=function(r){return new n(function(n){return n(r)})},n.freeze=function(r){var t,e,o,u;return o=!0,e=void 0,t=[],u=r._go(function(n){var r,u,i;if(o){for(e=n,o=!1,u=0,i=t.length;i>u;u++)(r=t[u])(n);return t=void 0}}),new n(function(n){return o?t.push(n):n(e),u})},n.safe=function(n,r){return function(t){var e,o;try{return r(t)}catch(o){return e=o,n}}},n.safeRaw=function(n){return function(r){var t,e;try{return n(r)}catch(e){return t=e}}},n.chain=function(r){return function(t){var e,o,u,i,a;if(r.length>0){for(e=r[0](t),a=r.slice(1),o=0,u=a.length;u>o;o++)i=a[o],e=e.next(i);return e}return n.wrap(void 0)}},n.repeat=function(n,r,t){var e;return null==t&&(t=!1),e=r._next(function(r){return r instanceof Error&&t||0===n--?r:e})},n.delay=function(r,t){return new n(function(n){return setTimeout(n,r)})._next(function(){return t})},n.retry=function(n,r){var t;return t=r.guard(function(r){return 0!==n--?t:new Error("RETRY_ERROR: Retry limit reached")})},n.parallel=function(r,t){var e;return null==t&&(t=!1),e=r.length,e>0?new n(function(n){var o,u,i,a,c,f,s,l;for(u=e,s=new Array(u),l=new Array(u),i=function(r){return function(e){return e instanceof Error&&t?("function"==typeof n&&n(e),n=void 0,u=-1):(s[r]=e,0===--u?n(s):void 0)}},a=c=0,f=r.length;f>c;a=++c)o=r[a],l[a]=o._go(i(a));return l}):n.wrap([])},n.join=function(t,e,o){var u;return u=new Array(2),new n(function(n){var i,a,c;return a=c=void 0,i=2,u[0]=t._go(function(t){return a=t,i--,0===i?r(n,o(a,c)):void 0}),u[1]=e._go(function(t){return c=t,i--,0===i?r(n,o(a,c)):void 0}),u})},n.race=function(r,t){var e;return null==t&&(t=!1),e=r.length,e>0?new n(function(n){var o,u,i,a,c,f;for(u=e,f=new Array(e),i=a=0,c=r.length;c>a;i=++a)o=r[i],f[i]=o._go(function(r){return u--,r instanceof Error&&!t?0===u?n(new Error("RACE_ERROR: All actions failed")):void 0:("function"==typeof n&&n(r),n=void 0,u=-1)});return f}):n.wrap(new Error("RACE_ERROR: All actions failed"))},n.sequence=function(r,t){var e,o;return null==t&&(t=!1),o=r.length,e=function(n,r,e,o){return n._next(function(n){return n instanceof Error&&t?n:(o[e]=n,r)})},new n(function(n){var u,i,a,c,f,s,l;if(l=new Array(o),o>0){for(u=r[0],s=r.slice(1),a=c=0,f=s.length;f>c;a=++c)i=s[a],u=e(u,i,a,l);return u._go(function(r){return r instanceof Error&&t?n(r):(l[o-1]=r,n(l))})}return n(l)})},t=function(n){return function(r,t){return n(r?r:t)}},n.makeNodeAction=function(r){return function(e,o,u){var i,a,c,f,s;switch(s=this,f=arguments.length){case 0:i=function(n){return r.call(s,t(n))};break;case 1:i=function(n){return r.call(s,e,t(n))};break;case 2:i=function(n){return r.call(s,e,o,t(n))};break;case 3:i=function(n){return r.call(s,e,o,u,t(n))};break;default:for(c=f,a=new Array(f+1);c-->0;)a[c]=arguments[c];i=function(n){return a[f]=t(n),r.apply(s,a)}}return new n(i)}},o=function(n,r,t){return r._go(function(r){var e,u,i;return r instanceof Error&&n["throw"](r),i=n.next(r),u=i.value,e=i.done,e?t(r):o(n,u,t)})},n.co=function(r){return function(){var t;return t=r.apply(this,arguments),new n(function(n){return o(t,t.next().value,n)})}},e=function(n,r){var t,o,u,i;u=[];for(t in r)i=r[t],o=n?n+"["+t+"]":t,"object"==typeof i?u.push(e(o,i)):null!=i&&u.push(encodeURIComponent(o)+"="+encodeURIComponent(i));return u.join("&")},n.param=function(n){return e("",n)},n.jsonp=function(r){return new n(function(n){var t,e;return t="callback_"+Math.round(1e16*Math.random()).toString(36),e=document.createElement("script"),window[t]=function(r){return e.parentNode.removeChild(e),n(r),window[t]=void 0},e.onerror=function(){return e.parentNode.removeChild(e),n(new Error("REQUEST_ERROR: error when making jsonp request")),window[t]=void 0,!1},e.onload=function(){return!1},e.src=r.url+(-1===r.url.indexOf("?")?"?":"&")+(r.callback?r.callback:"callback")+"="+t,e.callbackName=t,document.body.appendChild(e),e})},n.ajax=function(r){return new n(function(n){var t,e,o,u;u=new window.XMLHttpRequest,u.open(r.method,r.url,!0,r.user,r.password),u.onload=function(){return 4===u.readyState?n(u.status>=200&&u.status<300?null!=r.responseType?u.response:u.responseText:new Error("REQUEST_ERROR: status"+u.status)):void 0},e=r.headers;for(t in e)o=e[t],u.setRequestHeader(t,o);switch(r.timeout&&(u.timeout=r.timeout,u.ontimeout=function(){return n(new Error("REQUEST_ERROR: timeout"))}),r.responseType&&(u.responseType=r.responseType),typeof r.data){case"string":u.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),u.send(r.data);break;case"object":r.data instanceof window.FormData?u.send(r.data):(u.setRequestHeader("Content-Type","application/json; charset=UTF-8"),u.send(JSON.stringify(r.data)));break;default:u.send()}return u})},"undefined"!=typeof module&&null!==module&&null!=module.exports?module.exports=n:"function"==typeof define&&define.amd?define(function(){return n}):"undefined"!=typeof window&&null!==window&&(window.Action=n)}).call(this);